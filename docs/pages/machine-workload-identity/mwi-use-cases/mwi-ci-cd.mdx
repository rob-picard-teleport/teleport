---
title: CI/CD with Machine & Workload Identity
description: Configuring CI/CD with Machine & Workload Identity
labels:
 - how-to
 - mwi
---

# Machine & Workload Identity for CI/CD

Teleport Machine & Workload Identity replaces long-lived static secrets in CI/CD pipelines with short-lived, automatically generated certificates.

Machine & Workload Identity has native integrations for many CI/CD providers and deployment targets. At the bottom of the page you can find links to how to Machine & Workload Identity with your tools.

# No More Secrets

This probably looks familiar: a CI/CD pipeline running in GitHub Actions on GitHub's infrastructure, outside of the company’s network. It builds a container and pushes it to an AWS Elastic Container Registry, and uses Helm to update a chart in a Kubernetes cluster with the new container image. To take those actions it needs two secrets stored in the GitHub Action settings:

- An AWS keypair  
- A Kubernetes config file

These secrets *should* be rotated every six months. The platform team generates them and passes them to the dev team to replace in the repository. The act of generating the new ones emits a log that goes to the security team, but there’s not a good way of connecting that with the audit log for the GitHub organization to ensure the rotation happened. None of the ways of getting it from the platform team to the dev team (Slack, email, file drop, shared password management vault) are ideal. Additionally, the Kubernetes cluster’s endpoint has to be public so the GitHub Actions infrastructure can reach it.

With Teleport Machine & Workload Identity, we generate two credentials when the job starts:

- A SPIFFE Verifiable Identity Document that is used with AWS IAM Roles Anywhere to authenticate with AWS ECR  
- A Kubernetes config file

Both are based on x.509 certificates that expire when the job ends, saving the platform and dev teams’ time. An audit log is emitted when they are generated, when they are used, and what actions are taken against the Kubernetes cluster by the process using the config file. The Kubernetes commands run through the Teleport proxy, so the endpoint of the Control Plane API can be made completely private, increasing the security of the whole cluster.

Teleport authenticates the pipeline using GitHub’s OIDC endpoint, confirming the organization, repository, and git ref of the pipeline to determine what credentials it is allowed to generate.

*No secrets are stored in the CI/CD tool, so there is nothing to exfiltrate.*

Get started securing your CI/CD pipelines:

## Further reading

- [Architecture](../../reference/architecture/machine-id-architecture.mdx): A technical deep-dive into how Machine ID
  works.
- [Reference](../../reference/machine-id/machine-id.mdx): Complete documentation of available
  configuration options.
